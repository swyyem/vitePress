import{_ as p,B as e,c as r,o as d,j as i,G as l,aT as y,a as s,w as k,M as n}from"./chunks/framework.KoO-uqrk.js";const m=JSON.parse('{"title":"javascript","description":"","frontmatter":{},"headers":[],"relativePath":"javaScript/index.md","filePath":"javaScript/index.md"}'),g={name:"javaScript/index.md"};function D(A,a,c,o,B,u){const h=e("CodePreview"),t=e("ClientOnly");return d(),r("div",null,[a[4]||(a[4]=i("h1",{id:"javascript",tabindex:"-1"},[s("javascript "),i("a",{class:"header-anchor",href:"#javascript","aria-label":'Permalink to "javascript"'},"​")],-1)),a[5]||(a[5]=i("h2",{id:"代码生成绝对唯一-id",tabindex:"-1"},[s("代码生成绝对唯一 ID "),i("a",{class:"header-anchor",href:"#代码生成绝对唯一-id","aria-label":'Permalink to "代码生成绝对唯一 ID"'},"​")],-1)),a[6]||(a[6]=i("ul",null,[i("li",null,"极低的碰撞概率：一个 v4 UUID 是由 122 位的随机数生成的，其组合数量是一个天文数字，碰撞概率趋近于零"),i("li",null,"加密级安全：它使用密码学安全伪随机数生成器（CSPRNG），其随机性远非 Math.random() 可比，无法被预测"),i("li",null,"标准化：它生成的是全球公认的标准格式，无论前端、后端还是数据库，都能识别和处理"),i("li",null,"原生、简单、高效：无需引入任何第三方库，一行代码即可调用，性能极高"),i("li",null,"跨平台：它可以在任何支持 JavaScript 的环境中运行，包括浏览器、Node.js、 Deno 等")],-1)),l(t,null,{default:k(()=>[l(h,n({code:`const uniqueId = crypto.randomUUID();
console.log(uniqueId);`},{expand:!0}),{default:k(()=>a[0]||(a[0]=[i("p",null,[i("span",null,[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"const"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," uniqueId"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," crypto"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"randomUUID"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"console"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"log"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"uniqueId"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")])])])])],-1)])),_:1,__:[0]},16)]),_:1}),a[7]||(a[7]=i("h2",{id:"前端日期处理",tabindex:"-1"},[s("前端日期处理 "),i("a",{class:"header-anchor",href:"#前端日期处理","aria-label":'Permalink to "前端日期处理"'},"​")],-1)),a[8]||(a[8]=i("ul",null,[i("li",null,[i("p",null,"不可靠的字符串解析"),i("p",null,"看这个经典的例子：")])],-1)),l(t,null,{default:k(()=>[l(h,n({code:`// 格式一：YYYY-MM-DD
const date1 = new Date('2025-07-15');
// 在多数现代浏览器中，这会被解析为 UTC 时间的零点：
// "Tue Jul 15 2025 08:00:00 GMT+0800 (中国标准时间)"
// 格式二：YYYY/MM/DD
const date2 = new Date('2025/07/15');
// 这通常会被解析为本地时间的零点：
// "Tue Jul 15 2025 00:00:00 GMT+0800 (中国标准时间)"`},{expand:!0}),{default:k(()=>a[1]||(a[1]=[i("p",null,[i("span",null,[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// 格式一：YYYY-MM-DD")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"const"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," date1"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," new"),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," Date"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"2025-07-15"),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// 在多数现代浏览器中，这会被解析为 UTC 时间的零点：")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},'// "Tue Jul 15 2025 08:00:00 GMT+0800 (中国标准时间)"')])])])])],-1),i("p",null,[i("span",null,[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// 格式二：YYYY/MM/DD")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"const"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," date2"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," new"),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," Date"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"2025/07/15"),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// 这通常会被解析为本地时间的零点：")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},'// "Tue Jul 15 2025 00:00:00 GMT+0800 (中国标准时间)"')])])])])],-1)])),_:1,__:[1]},16)]),_:1}),a[9]||(a[9]=i("h2",{id:"对象的可变性-mutability",tabindex:"-1"},[s("对象的可变性（Mutability） "),i("a",{class:"header-anchor",href:"#对象的可变性-mutability","aria-label":'Permalink to "对象的可变性（Mutability）"'},"​")],-1)),a[10]||(a[10]=i("p",null,"想象一个场景：",-1)),l(t,null,{default:k(()=>[l(h,n({code:`const today = new Date(2025-07-31); //假设日期是2025-07-31
function getNextDay(date) {
date.setDate(date.getDate() + 1);//直接修改了传入的date对象
return date;
}
const nextDay = getNextDay(today);
console.log('今天是:',today);//有问题
console.log('明天是:',nextDay);//正确`},{expand:!0}),{default:k(()=>a[2]||(a[2]=[i("p",null,[i("span",null,[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"const"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," today"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," new"),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," Date"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"2025"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"07"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"31"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");"),i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}}," //假设日期是2025-07-31")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"function"),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," getNextDay"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"date"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"date"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"setDate"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"date"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"getDate"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"()"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," +"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 1"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");"),i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"//直接修改了传入的date对象")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"return"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," date"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"const"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," nextDay"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," getNextDay"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"today"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"console"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"log"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"今天是:"),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},","),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"today"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");"),i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"//有问题")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"console"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"log"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"明天是:"),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},","),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"nextDay"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");"),i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"//正确")])])])])],-1)])),_:1,__:[2]},16)]),_:1}),a[11]||(a[11]=y('<h2 id="jsonp的实现" tabindex="-1">JSONP的实现 <a class="header-anchor" href="#jsonp的实现" aria-label="Permalink to &quot;JSONP的实现&quot;">​</a></h2><h3 id="jsonp-的核心思想-一个-美丽的误会" tabindex="-1">JSONP 的核心思想：一个“美丽的误会” <a class="header-anchor" href="#jsonp-的核心思想-一个-美丽的误会" aria-label="Permalink to &quot;JSONP 的核心思想：一个“美丽的误会”&quot;">​</a></h3><ul><li><p>同源策略限制了 XMLHttpRequest，但它有一个“漏洞”：它并不限制带有 src 属性的标签，比如 <code>&lt;script&gt;</code>、<code>&lt;img&gt;</code> 和 <code>&lt;iframe&gt;</code>。它们天生就具备从任何地方加载资源的能力，否则你就无法在你的网站上使用 CDN 的图片或脚本了。</p></li><li><p>JSONP 正是利用了 <code>&lt;script&gt;</code> 标签的这个特性。它的核心思想可以概括为以下对话：</p></li><li><p>前端页面：（对服务器喊话）“你好，我需要一些数据。但我不能直接用 AJAX 拿。这样吧，我动态创建一个 <code>&lt;script&gt;</code> 标签来请求你的一个地址。另外，我已经在我的页面上准备好了一个叫 myCallbackFunction 的函数，请你把数据作为参数，放进这个函数调用里，然后把整个 myCallbackFunction({ ...data... }) 作为一段 JavaScript 文本返回给我。” 服务器：（收到请求后）“好的，没问题。这是你要的数据，我已经用你指定的回调函数名‘包裹’（Padding）好了。” 于是，当前端页面加载完这个 <code>&lt;script&gt;</code> 标签后，它实际上是在执行一段从服务器返回的 JavaScript 代码，这段代码恰好调用了我们预先定义好的全局函数，数据也就自然而然地被传递了进来。</p></li><li><p>整个过程没有使用 XMLHttpRequest，完美绕过了同源策略。</p></li></ul><h3 id="动手实现-打造我们自己的-jsonp-工具" tabindex="-1">动手实现：打造我们自己的 JSONP 工具 <a class="header-anchor" href="#动手实现-打造我们自己的-jsonp-工具" aria-label="Permalink to &quot;动手实现：打造我们自己的 JSONP 工具&quot;">​</a></h3><ul><li>让我们来封装一个通用的 jsonp 函数。它应该接收一个包含 url、params 和 callback 的配置对象。</li></ul>',5)),l(t,null,{default:k(()=>[l(h,n({code:`// 一个简单的 JSONP 实现
// url - 请求的 URL 地址
// params - 需要传递的参数
// callbackKey='callback' - 与后端约定的回调函数参数名
//callback - 成功时调用的回调函数
function jsonp({ url, params = {}, callbackKey = 'callback', callback }) {
// 1. 生成一个独一无二的回调函数名，防止并发请求时冲突
const callbackName = \`jsonp_callback_\${Date.now()}_\${Math.floor(Math.random() * 100000)}\`;
// 2. 将回调函数挂载到 window 上，使其成为全局函数
// 这是最关键的一步，因为服务器返回的脚本将直接调用这个函数
window\\[callbackName] = function(data) {
// 成功接收到数据后，调用我们真正的回调函数
callback(data);
};
// 4. 准备参数，并将其拼接到 URL 上
const paramsArray = \\[];
for (let key in params) {
paramsArray.push(\`\${encodeURIComponent(key)}=\${encodeURIComponent(params[key])}\`);
}
// 加上与后端约定的回调函数名参数
paramsArray.push(\`\${callbackKey}=\${callbackName}\`);
const paramsString = paramsArray.join('&');
const finalUrl = url.includes('?') ? \`\${url}&\${paramsString}\` : \`\${url}?\${paramsString}\`;
// 5. 创建并注入 <script> 标签，发起请求
const scriptElement = document.createElement('script');
scriptElement.src = finalUrl;
document.head.appendChild(scriptElement);
// （可选）错误处理
}`},{expand:!0}),{default:k(()=>a[3]||(a[3]=[i("p",null,[i("span",null,[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// 一个简单的 JSONP 实现")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// url - 请求的 URL 地址")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// params - 需要传递的参数")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// callbackKey='callback' - 与后端约定的回调函数参数名")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"//callback - 成功时调用的回调函数")])])])])],-1),i("p",null,[i("span",null,[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"function"),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," jsonp"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"({"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," url"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},","),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," params"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," {},"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," callbackKey"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}}," '"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"callback"),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},","),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," callback"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," })"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// 1. 生成一个独一无二的回调函数名，防止并发请求时冲突")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"const"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," callbackName"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}}," `"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"jsonp_callback_"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"${"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"Date"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"now"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"()"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"}"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"_"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"${"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"Math"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"floor"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"Math"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"random"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"()"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," *"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 100000"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"}"),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"`"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")])])])])],-1),i("p",null,[i("span",null,[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// 2. 将回调函数挂载到 window 上，使其成为全局函数")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// 这是最关键的一步，因为服务器返回的脚本将直接调用这个函数")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"window"),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"\\"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"["),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"callbackName"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"]"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," function"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"data"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// 成功接收到数据后，调用我们真正的回调函数")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"callback"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"data"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")])])])])],-1),i("div",{class:"language- vp-adaptive-theme line-numbers-mode"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",null,"// 3. 清理工作：用完即焚")]),s(`
`),i("span",{class:"line"},[i("span",null,"// 移除挂载到 window 上的函数，避免内存泄漏和全局污染")]),s(`
`),i("span",{class:"line"},[i("span",null,"delete window[callbackName];")]),s(`
`),i("span",{class:"line"},[i("span",null,"// 移除注入的 script 标签")]),s(`
`),i("span",{class:"line"},[i("span",null,"document.head.removeChild(scriptElement);")])])]),i("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[i("span",{class:"line-number"},"1"),i("br"),i("span",{class:"line-number"},"2"),i("br"),i("span",{class:"line-number"},"3"),i("br"),i("span",{class:"line-number"},"4"),i("br"),i("span",{class:"line-number"},"5"),i("br")])],-1),i("p",null,[i("span",null,[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"}"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")])])])])],-1),i("p",null,[i("span",null,[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// 4. 准备参数，并将其拼接到 URL 上")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"const"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," paramsArray"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," \\"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"[];")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"for"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ("),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"let"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," key"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," in"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," params"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"paramsArray"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"push"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"`"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"${"),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"encodeURIComponent"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"key"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"}"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"="),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"${"),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"encodeURIComponent"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"params"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"["),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"key"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"])"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"}"),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"`"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// 加上与后端约定的回调函数名参数")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"paramsArray"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"push"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"`"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"${"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"callbackKey"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"}"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"="),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"${"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"callbackName"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"}"),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"`"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")])])])])],-1),i("p",null,[i("span",null,[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"const"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," paramsString"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," paramsArray"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"join"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"&"),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"const"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," finalUrl"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," url"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"includes"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"?"),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," ?"),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}}," `"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"${"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"url"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"}"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"&"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"${"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"paramsString"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"}"),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"`"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," :"),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}}," `"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"${"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"url"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"}"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"?"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"${"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"paramsString"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"}"),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"`"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")])])])])],-1),i("p",null,[i("span",null,[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// 5. 创建并注入 <script> 标签，发起请求")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"const"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," scriptElement"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," document"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"createElement"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"script"),i("span",{style:{"--shiki-light":"#B5695977","--shiki-dark":"#C98A7D77"}},"'"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"scriptElement"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"src"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," finalUrl"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"document"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"head"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"."),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"appendChild"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"scriptElement"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},");")])])])])],-1),i("p",null,[i("span",null,[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"// （可选）错误处理")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"}")])])])])],-1)])),_:1,__:[3]},16)]),_:1})])}const b=p(g,[["render",D]]);export{m as __pageData,b as default};
