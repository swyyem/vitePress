# 目前最广泛接受的规范是 Conventional Commits

## 1. 提交信息的基本结构

一条规范的提交信息应该包含三个部分：**_标题_**、**_正文_**和**_页脚_**。其中，**_标题_**是必需的，格式有严格规定。

```text
<类型>[可选 作用域]: <描述>

[可选 正文]

[可选 页脚]
```

## 2. 提交标题

这是提交信息中最重要的一行，必须符合特定格式。

### 2.1 提交类型

`类型` 用于说明本次提交的类别，通常使用以下前缀：

| 类型       | 说明                                                                          |
| :--------- | :---------------------------------------------------------------------------- |
| `feat`     | **_新功能_** - 新增了一个功能                                                 |
| `fix`      | **_修复Bug_** - 修复了一个Bug                                                 |
| `docs`     | **_文档_** - 仅修改了文档（如 README.md）                                     |
| `style`    | **_代码风格_** - 修改了代码格式、缩进、分号等，不影响代码逻辑（非CSS样式）    |
| `refactor` | **_重构_** - 既不是新增功能，也不是修改Bug的代码变动                          |
| `perf`     | **_性能优化_** - 提升性能的代码更改                                           |
| `test`     | **_测试_** - 增加或修改测试用例                                               |
| `build`    | **_构建系统_** - 影响构建系统或外部依赖的更改（如 npm, gulp, webpack）        |
| `ci`       | **_CI配置_** - 更改持续集成系统的配置或脚本（如 Travis, Jenkins, GitLab CI）  |
| `chore`    | **_杂项_** - 其他不修改源代码或测试文件的变动（如更新构建任务、包管理器配置） |
| `revert`   | **_回滚_** - 回滚之前的某个提交                                               |

### 2.2 作用域

`作用域` 用于说明本次提交影响的范围，通常是模块、组件或文件的名称。它是可选的。

例如：

- `feat(用户): 添加用户注册功能`
- `fix(订单): 修复订单金额计算错误`

### 2.3 描述

`描述` 是对本次提交的简短总结。

**_要求：_**

- 使用祈使句、现在时态，例如 "change"，而不是 "changed" 或 "changes"。
- 不要首字母大写。
- 结尾不要加句号。

## 3. 正文

在标题之后，可以编写更详细的正文，说明本次提交的**_动机、与之前行为的对比_**。每行保持72个字符以内。

**_使用空行将标题和正文分开。_**

## 4. 页脚

页脚通常用于以下两种情况：

- **_不兼容的变更 (BREAKING CHANGE)_**：如果当前代码与上一个版本不兼容，则需要在页脚中以 `BREAKING CHANGE:` 开头，后面跟上变更的描述、理由和迁移方法。
- **_关联Issue_**：关闭某个Issue。

例如：

```text
Closes #123, #245
BREAKING CHANGE: 重构用户登录模块，移除了xxxAPI，请使用yyyAPI替代。
```

## 5. 优秀示例

### 示例1：最简单的功能提交

```text
feat: 添加用户登录功能
```

### 示例2：带作用域和详细描述的Bug修复

```text
fix(api): 修复用户列表接口分页失效的问题

在请求用户列表时，即使传入了page参数，返回的也是全部数据。
原因是Service层没有正确接收分页参数。

Closes #123
```

### 示例3：带不兼容变更的重构

```text
refactor(构建): 将构建系统从Grunt迁移至Webpack

BREAKING CHANGE: 原有的 `grunt build` 命令已失效，请使用 `npm run build` 进行项目构建。
```

### 示例4：复杂的特性提交（含标题、正文、页脚）

```text
feat(编译器): 增加对箭头函数的解析支持

- 实现了箭头函数的词法分析
- 实现了箭头函数的语法树生成
- 更新了相关的测试用例

BREAKING CHANGE: 由于语法树结构变更，所有依赖旧版AST结构的插件可能需要更新。
Closes #456
```

## 6. 为什么需要使用这套规范？

1. **_生成可读的提交历史_**：便于快速浏览项目演进。
2. **_自动化生成 CHANGELOG_**：工具可以根据 `feat` 和 `fix` 类型自动生成更新日志。
3. **_触发构建和发布流程_**：`feat`、`fix` 和 `BREAKING CHANGE` 可以帮助工具自动确定语义化版本号（Semantic Versioning）。
   - fix -> 发布修订版本 1.0.1
   - feat -> 发布次版本 1.1.0
   - BREAKING CHANGE -> 发布主版本 2.0.0
4. **_提高团队协作效率_**：让其他开发者清楚地了解每个提交的意图和影响范围。

## 7. 工具推荐

- **_Commitizen_**: 一个交互式工具，帮助你一步步生成符合规范的提交信息。
- **_@commitlint/config-conventional_**: 一个校验工具，可以配置 Git Hooks（如 `commit-msg`）来检查提交信息是否符合规范。
- **_standard-version_**: 一个用于自动生成 CHANGELOG 和升级版本号的工具。

## 总结

采用并坚持使用这套规范，会极大地提升你和你的团队的专业度和协作效率。建议从个人项目开始练习，然后在团队中推广。

```text
1. 每个提交都必须使用类型字段前缀，它由一个名词构成，诸如 feat 或 fix ， 其后接可选的范围字段，可选的 !，以及必要的冒号（英文半角）和空格。
2. 当一个提交为应用或类库实现了新功能时，必须使用 feat 类型。
3. 当一个提交为应用修复了 bug 时，必须使用 fix 类型。
4. 范围字段可以跟随在类型字段后面。范围必须是一个描述某部分代码的名词，并用圆括号包围，例如： fix(parser):
5. 描述字段必须直接跟在 <类型>(范围) 前缀的冒号和空格之后。 描述指的是对代码变更的简短总结，例如： fix: array parsing issue when multiple spaces were contained in string 。
6. 在简短描述之后，可以编写较长的提交正文，为代码变更提供额外的上下文信息。正文必须起始于描述字段结束的一个空行后。
7. 提交的正文内容自由编写，并可以使用空行分隔不同段落。
8. 在正文结束的一个空行之后，可以编写一行或多行脚注。每行脚注都必须包含 一个令牌（token），后面紧跟 :<space> 或 <space># 作为分隔符，后面再紧跟令牌的值（受 git trailer convention 启发）。
9. 脚注的令牌必须使用 - 作为连字符，比如 Acked-by (这样有助于 区分脚注和多行正文)。有一种例外情况就是 BREAKING CHANGE，它可以被认为是一个令牌。
10. 脚注的值可以包含空格和换行，值的解析过程必须直到下一个脚注的令牌/分隔符出现为止。
11. 破坏性变更必须在提交信息中标记出来，要么在 <类型>(范围) 前缀中标记，要么作为脚注的一项。
12. 包含在脚注中时，破坏性变更必须包含大写的文本 BREAKING CHANGE，后面紧跟着冒号、空格，然后是描述，例如： BREAKING CHANGE: environment variables now take precedence over config files 。
13. 包含在 <类型>(范围) 前缀时，破坏性变更必须通过把 ! 直接放在 : 前面标记出来。 如果使用了 !，那么脚注中可以不写 BREAKING CHANGE:， 同时提交信息的描述中应该用来描述破坏性变更。
14. 在提交说明中，可以使用 feat 和 fix 之外的类型，比如：docs: updated ref docs. 。
15. 工具的实现必须不区分大小写地解析构成约定式提交的信息单元，只有 BREAKING CHANGE 必须是大写的。
16. BREAKING-CHANGE 作为脚注的令牌时必须是 BREAKING CHANGE 的同义词。
```
