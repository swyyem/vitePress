# 数据类型转换

## === （全等）严格的相亲

**_规则非常简单：先看类型，再看值。如果类型不同，直接 false。_**

- 不会做任何类型转换。
- 结果非常严格、可预测。
- 在绝大多数情况下，推荐使用 ===，避免意外。

```javascript
console.log(5 === 5); // true   -> 都是数字，值也一样
console.log(5 === '5'); // false  -> 一个是数字，一个是字符串，类型不同，直接淘汰！

console.log(true === 1); // false  -> 布尔值和数字，类型不同
console.log(null === undefined); // false -> 虽然是“空”亲戚，但类型不同
console.log(0 === false); // false  -> 数字和布尔值，类型不同
```

## == （相等）和事佬媒婆

**_规则很复杂：如果类型不同，它会尝试“牵线搭桥”（隐式转换），把它们转成相同类型再比较。_**

### 潜规则1：数字和字符串相亲

- 媒婆会把字符串转换成数字，然后再比较。

```javascript
console.log(5 == '5'); // true
// 媒婆心里想：'5' (字符串) 可以变成 5 (数字)
// 然后比较 5 == 5，成功！

console.log(1 == '1'); // true
console.log(1 == '1哈哈'); // false，因为 '1哈哈' 转成数字是 NaN，NaN 和任何值都不相等
```

## 潜规则2：布尔值和任何人相亲

- 媒婆会把布尔值转换成数字，然后再比较。

```javascript
console.log(true == 1); // true
// 媒婆心里想：true 可以变成 1 (数字)
// 然后比较 1 == 1，成功！

console.log(false == 0); // true
// false -> 0, 然后 0 == 0

console.log(true == '1'); // true
// 分两步：
// 1. true -> 1
// 2. '1' -> 1
// 然后比较 1 == 1

console.log(false == ''); // true
// 分两步：
// 1. false -> 0
// 2. '' (空字符串) -> 0
// 然后比较 0 == 0
```

### 潜规则3：null 和 undefined 相亲

**_它们是“官方CP”，在 == 时互相相等，但不和别人乱搞关系。_**

```javascript
console.log(null == undefined); // true -> 官方CP，可以匹配
console.log(null == 0); // false -> 不和数字搞关系
console.log(undefined == ''); // false -> 不和字符串搞关系
```

### 潜规则4：对象和基本类型相亲

- 媒婆会调用对象的 valueOf() 或 toString() 方法，把对象转换成基本类型（通常是字符串），再进行比较。

```javascript
// 数组（一种对象）和字符串比较
console.log([1, 2] == '1,2'); // true
// 媒婆心里想：数组 [1,2] 调用 toString() 变成了 "1,2"
// 然后比较 "1,2" == "1,2"，成功！

// 数组和数字比较
console.log([5] == 5); // true
// 媒婆心里想：
// 1. 数组 [5] 先变成字符串 "5"
// 2. 字符串 "5" 再变成数字 5
// 然后比较 5 == 5，成功！
```

## 回答

```text
“它们最核心的区别在于处不处理类型转换。

=== (全等) 是严格比较。它要求类型和值都必须完全相同才会返回 true。它不会做任何类型的隐式转换，所以结果非常可预测。在开发中，我绝大部分时间都会使用 ===。

== (相等) 是宽松比较。如果比较的双方类型不同，它会按照一套复杂的规则进行隐式类型转换，试图让它们变得可比后再判断值是否相等。

比如数字和字符串比较，它会尝试把字符串转成数字。

布尔值和非布尔值比较，它会先把布尔值转成数字（true为1，false为0）。

null 和 undefined 在 == 比较时是相等的。

正是因为 == 的隐式转换规则难以记忆且反直觉，容易产生意想不到的Bug，所以在现代JavaScript开发中，我们更推荐使用 === 来保证代码的清晰和健壮。”
```

```javascript
// 这些都是 true！你能一眼看出来吗？
console.log(false == '0'); // true
console.log(' \t\r\n ' == 0); // true (空字符、制表符、换行符转成数字是0)
console.log([] == false); // true
console.log([] == ![]); // true (![]是false，然后 [] 转成 ""，再转成0，false转成0)
```
